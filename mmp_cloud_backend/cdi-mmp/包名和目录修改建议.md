# CDI-MMP 模块包名和目录名修改建议

生成日期：2026-01-08
最后更新：2026-01-08

## 执行状态

### ✅ 已完成的工作

1. **coresystem 模块重构**：已完成包名修改为 `org.dromara.cdi.mmp.coresystem`，编译通过
2. **Mapper 文件清理**：所有模块的 mapper 目录已清理，只保留相关 XML 文件
3. **目录结构优化**：mapper 子目录已重命名为对应模块名（doctor/, emergency/ 等）
4. **备份文件清理**：删除了所有无关的备份文件

### 🔄 待完成的工作

- 其他9个模块的包名重构（doctor, emergency, ntp, qc, qualification, radiation, supervision, surgery, tumorqc）
- 创建独立的 Spring Boot 启动类和配置文件（可选，用于模块独立运行）

### 📊 当前统计

| 模块 | Java 文件数 | XML 文件数 | 重构状态 |
|------|------------|-----------|----------|
| cdi-mmp-coresystem | 约 120 个 | 14 个 | ✅ 已完成 |
| cdi-mmp-doctor | 约 120 个 | 17 个 | ⏳ 待重构 |
| cdi-mmp-emergency | 约 120 个 | 11 个 | ⏳ 待重构 |
| cdi-mmp-ntp | 约 120 个 | 8 个 | ⏳ 待重构 |
| cdi-mmp-qc | 约 120 个 | 8 个 | ⏳ 待重构 |
| cdi-mmp-qualification | 约 120 个 | 11 个 | ⏳ 待重构 |
| cdi-mmp-radiation | 约 120 个 | 13 个 | ⏳ 待重构 |
| cdi-mmp-supervision | 约 120 个 | 15 个 | ⏳ 待重构 |
| cdi-mmp-surgery | 约 120 个 | 6 个 | ⏳ 待重构 |
| cdi-mmp-tumorqc | 约 120 个 | 8 个 | ⏳ 待重构 |
| **总计** | **约 1080 个** | **约 111 个** | - |

**说明**：XML 文件数已大幅减少，因为已清理了无关文件。

## 问题分析

经过代码分析，发现所有 `cdi-mmp` 子模块都使用了 `org.dromara.system` 作为基础包名。这与项目中已存在的 `ruoyi-modules/ruoyi-system` 模块的包名相同，会导致以下问题：

1. **包名冲突**：多个模块使用相同的包名会导致类名冲突
2. **代码混淆**：难以区分代码属于哪个业务模块
3. **维护困难**：后期维护和重构时容易出错
4. **模块边界不清晰**：违反了模块化设计的最佳实践

## 建议的包名结构

### 方案一：使用 cdi.mmp 作为基础包名（推荐）

```
org.dromara.cdi.mmp.coresystem    # 核心制度模块
org.dromara.cdi.mmp.doctor        # 医师管理模块
org.dromara.cdi.mmp.emergency     # 应急管理模块
org.dromara.cdi.mmp.ntp           # 新技术新项目模块
org.dromara.cdi.mmp.qc            # 质量控制模块
org.dromara.cdi.mmp.qualification # 资质管理模块
org.dromara.cdi.mmp.radiation     # 放射管理模块
org.dromara.cdi.mmp.supervision   # 监督管理模块
org.dromara.cdi.mmp.surgery       # 手术管理模块
org.dromara.cdi.mmp.tumorqc       # 肿瘤质控模块
```

### 方案二：使用 mmp 作为基础包名（简化版）

```
org.dromara.mmp.coresystem
org.dromara.mmp.doctor
org.dromara.mmp.emergency
org.dromara.mmp.ntp
org.dromara.mmp.qc
org.dromara.mmp.qualification
org.dromara.mmp.radiation
org.dromara.mmp.supervision
org.dromara.mmp.surgery
org.dromara.mmp.tumorqc
```

### 方案三：使用 com.cdi.mmp 作为基础包名（用户建议）

```
com.cdi.mmp.coresystem    # 核心制度模块
com.cdi.mmp.doctor        # 医师管理模块
com.cdi.mmp.emergency     # 应急管理模块
com.cdi.mmp.ntp           # 新技术新项目模块
com.cdi.mmp.qc            # 质量控制模块
com.cdi.mmp.qualification # 资质管理模块
com.cdi.mmp.radiation     # 放射管理模块
com.cdi.mmp.supervision   # 监督管理模块
com.cdi.mmp.surgery       # 手术管理模块
com.cdi.mmp.tumorqc       # 肿瘤质控模块
```

#### 方案三分析

**技术可行性**：✅ 可以修改，Java 语法上完全支持

**优点**：
- 使用 `com` 域名，符合 Java 包命名规范
- 包名更简洁
- 如果您拥有 `cdi.com` 域名，符合反向域名规范

**缺点**：
- **项目一致性问题**：整个项目都使用 `org.dromara` 作为基础包名
- **域名所有权**：需要确认您是否拥有 `cdi.com` 域名的所有权
- **潜在冲突**：`com.cdi` 可能与其他项目冲突
- **维护成本**：与项目整体风格不一致，增加维护复杂度

**建议**：
- 如果您坚持使用 `com.cdi.mmp`，这是可行的，但需要考虑：
  1. 是否拥有 `cdi.com` 域名
  2. 团队是否同意打破项目的一致性
  3. 是否有特殊的企业命名要求

**推荐选择**：建议优先选择**方案一**（org.dromara.cdi.mmp），保持项目一致性。

## 目录名称评估

### 当前目录结构（合理，无需修改）

```
cdi-mmp/
├── cdi-mmp-coresystem/    # 核心制度
├── cdi-mmp-doctor/        # 医师管理
├── cdi-mmp-emergency/     # 应急管理
├── cdi-mmp-ntp/          # 新技术新项目（New Technology & Project）
├── cdi-mmp-qc/           # 质量控制（Quality Control）
├── cdi-mmp-qualification/# 资质管理
├── cdi-mmp-radiation/    # 放射管理
├── cdi-mmp-supervision/  # 监督管理
├── cdi-mmp-surgery/      # 手术管理
└── cdi-mmp-tumorqc/      # 肿瘤质控
```

**结论**：目录命名符合规范，建议保持不变。

## 需要修改的文件清单

### 每个模块需要修改的文件类型：

#### 1. Java 源代码文件
- **位置**：`src/main/java/org/dromara/system/**/*.java`
- **修改内容**：将包声明 `package org.dromara.system.*` 改为 `package org.dromara.cdi.mmp.<模块名>.*`
- **影响范围**：
  - controller 包下的所有控制器类
  - service 包下的所有服务接口和实现类
  - mapper 包下的所有 Mapper 接口
  - domain 包下的所有实体类、BO、VO 类
  - listener 包下的监听器类
  - runner 包下的启动器类

#### 2. Mapper XML 配置文件
- **位置**：`src/main/resources/mapper/**/*.xml`
- **修改内容**：
  - `namespace` 属性中的包名
  - `resultType` 和 `resultMap` 中的类型引用
  - 示例：`namespace="org.dromara.system.mapper.XxxMapper"` 改为 `namespace="org.dromara.cdi.mmp.<模块名>.mapper.XxxMapper"`

#### 3. Spring Boot 配置文件（如果存在）
- **位置**：`src/main/resources/application.yml` 或 `application.properties`
- **修改内容**：
  - MyBatis mapper 扫描路径配置
  - 组件扫描路径配置

#### 4. Spring Boot 启动类（需要创建）
- 每个模块需要创建一个 Spring Boot 应用程序入口类
- **位置建议**：`src/main/java/org/dromara/cdi/mmp/<模块名>/Application.java`
- **示例**：
```java
package org.dromara.cdi.mmp.doctor;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class CdiMmpDoctorApplication {
    public static void main(String[] args) {
        SpringApplication.run(CdiMmpDoctorApplication.class, args);
    }
}
```

## 详细修改步骤

### 步骤 1：选择包名方案
- 建议采用**方案一**（org.dromara.cdi.mmp）或**方案三**（com.cdi.mmp）
- 方案一：保持项目一致性，推荐使用
- 方案三：如果您有特殊的企业命名要求，可以选择

### 步骤 2：重构包结构
针对每个模块，执行以下操作：

1. **创建新的包结构**
   ```
   src/main/java/org/dromara/cdi/mmp/<模块名>/
   ├── controller/
   ├── service/
   │   └── impl/
   ├── mapper/
   ├── domain/
   │   ├── bo/
   │   └── vo/
   ├── listener/
   └── runner/
   ```

2. **移动 Java 文件**
   - 将所有 Java 文件从 `org/dromara/system/` 移动到 `org/dromara/cdi/mmp/<模块名>/`
   - 保持子包结构不变（controller、service、mapper 等）

3. **批量修改包声明**
   - 使用 IDE 的重构功能（推荐）
   - 或使用文本替换工具批量替换包声明

### 步骤 3：更新 Mapper XML 文件
针对每个模块的 XML 文件：
```xml
<!-- 修改前 -->
<mapper namespace="org.dromara.system.mapper.MmpDoctorMapper">
    <resultMap type="org.dromara.system.domain.MmpDoctor">
    </resultMap>
</mapper>

<!-- 修改后 -->
<mapper namespace="org.dromara.cdi.mmp.doctor.mapper.MmpDoctorMapper">
    <resultMap type="org.dromara.cdi.mmp.doctor.domain.MmpDoctor">
    </resultMap>
</mapper>
```

### 步骤 4：创建启动类和配置文件
每个模块需要：
1. 创建 Application 启动类
2. 创建 application.yml 配置文件
3. 配置端口号（每个模块使用不同端口）

### 步骤 5：验证修改
1. 使用 Maven 编译：`mvn clean compile`
2. 检查编译错误
3. 运行测试（如果有）

## 各模块具体改动统计

根据代码扫描和清理结果，每个模块的实际文件数量如下：

| 模块 | Java 文件数 | XML 文件数（实际） | 重构状态 | 备注 |
|------|------------|-------------------|----------|------|
| cdi-mmp-coresystem | 约 120 个 | 14 个 | ✅ 已完成 | 核心制度模块，已重构并编译通过 |
| cdi-mmp-doctor | 约 120 个 | 17 个 | ⏳ 待重构 | 医师管理模块，XML 已清理 |
| cdi-mmp-emergency | 约 120 个 | 11 个 | ⏳ 待重构 | 应急管理模块，XML 已清理 |
| cdi-mmp-ntp | 约 120 个 | 8 个 | ⏳ 待重构 | 新技术新项目，XML 已清理 |
| cdi-mmp-qc | 约 120 个 | 8 个 | ⏳ 待重构 | 质量控制，XML 已清理 |
| cdi-mmp-qualification | 约 120 个 | 11 个 | ⏳ 待重构 | 资质管理，XML 已清理 |
| cdi-mmp-radiation | 约 120 个 | 13 个 | ⏳ 待重构 | 放射管理，XML 已清理 |
| cdi-mmp-supervision | 约 120 个 | 15 个 | ⏳ 待重构 | 监督管理，XML 已清理 |
| cdi-mmp-surgery | 约 120 个 | 6 个 | ⏳ 待重构 | 手术管理，XML 已清理 |
| cdi-mmp-tumorqc | 约 120 个 | 8 个 | ⏳ 待重构 | 肿瘤质控，XML 已清理 |
| **总计** | **约 1080 个** | **约 111 个** | - | XML 文件已大幅减少 |

**说明**：XML 文件数已更新为实际清理后的数量，每个模块只保留相关的 XML 文件。

## 包名方案对比

| 方案 | 包名示例 | 优点 | 缺点 | 推荐度 |
|------|----------|------|------|--------|
| 方案一 | `org.dromara.cdi.mmp.doctor` | 项目一致性好，标准规范 | 包名较长 | ⭐⭐⭐⭐⭐ |
| 方案二 | `org.dromara.mmp.doctor` | 简洁，项目一致性好 | 缺少业务层级 | ⭐⭐⭐ |
| 方案三 | `com.cdi.mmp.doctor` | 简洁，使用 com 域名 | 项目一致性差，可能域名冲突 | ⭐⭐ |

## 使用 IDE 进行重构的建议

### IntelliJ IDEA 操作步骤：

1. **重命名包**
   - 右键点击 `org.dromara.system` 包
   - 选择 `Refactor` -> `Rename`
   - 输入新包名 `org.dromara.cdi.mmp.<模块名>`
   - 选择 `Search in comments and strings` 和 `Search for text occurrences`
   - 点击 `Refactor` 执行重构

2. **移动包**
   - 选中需要移动的包
   - 使用 `F6` 或右键 `Refactor` -> `Move`
   - 指定目标位置
   - IDE 会自动更新所有引用

3. **验证重构**
   - 使用 `Ctrl+Shift+F9` 重新编译模块
   - 查看 `Problems` 视图检查错误

### Eclipse 操作步骤：

1. 右键点击包 -> `Refactor` -> `Rename Package`
2. 输入新包名并执行
3. Eclipse 会自动更新所有引用

## 继续重构其他模块的步骤

### 前提条件
- coresystem 模块已完成重构，可作为参考模板
- 所有模块的 XML 文件已清理完毕
- Mapper 目录结构已优化

### 重构流程（针对每个模块）

#### 步骤 1：包结构重构
针对 doctor, emergency, ntp, qc, qualification, radiation, supervision, surgery, tumorqc 模块：

1. **创建新的包目录结构**
   ```
   src/main/java/org/dromara/cdi/mmp/<模块名>/
   ├── controller/
   ├── service/
   │   └── impl/
   ├── mapper/
   ├── domain/
   │   ├── bo/
   │   └── vo/
   ├── listener/
   └── runner/
   ```

2. **移动 Java 文件**
   - 将 `org/dromara/<模块名>/` 下的所有文件移动到 `org/dromara/cdi/mmp/<模块名>/`
   - 保持子包结构不变

3. **批量更新包声明**
   - 将 `package org.dromara.<模块名>` 改为 `package org.dromara.cdi.mmp.<模块名>`

#### 步骤 2：更新 XML 文件
- 更新 namespace 和类型引用中的包名
- 从 `org.dromara.<模块名>` 改为 `org.dromara.cdi.mmp.<模块名>`

#### 步骤 3：编译验证
- 运行 `mvn clean compile` 验证编译通过
- 解决任何编译错误

### 自动化脚本建议

可以使用以下 PowerShell 脚本批量处理：

```powershell
# 示例：重构 doctor 模块
$module = "doctor"
# 1. 创建目录
New-Item -ItemType Directory -Path "src/main/java/org/dromara/cdi/mmp/$module" -Force
# 2. 移动文件
Move-Item -Path "src/main/java/org/dromara/$module/*" -Destination "src/main/java/org/dromara/cdi/mmp/$module/" -Force
# 3. 更新包声明
Get-ChildItem -Recurse -Filter "*.java" | ForEach-Object {
    (Get-Content $_.FullName) -replace "package org\.dromara\.$module", "package org.dromara.cdi.mmp.$module" | Set-Content $_.FullName
}
# 4. 更新 XML 文件
Get-ChildItem -Recurse -Filter "*.xml" | ForEach-Object {
    (Get-Content $_.FullName) -replace "org\.dromara\.$module", "org.dromara.cdi.mmp.$module" | Set-Content $_.FullName
}
```

### 优先级建议

1. **高优先级**：doctor, emergency, supervision（核心业务模块）
2. **中优先级**：qc, qualification, radiation（管理模块）
3. **低优先级**：ntp, surgery, tumorqc（专项模块）

### 注意事项

- 每个模块重构完成后务必编译验证
- 保持与 coresystem 模块相同的包结构
- 如遇到编译错误，参考 coresystem 模块的解决方案
- 建议逐个模块处理，不要批量重构所有模块

## 注意事项

1. **备份代码**：在执行大规模重构前，请务必提交当前代码或创建备份
2. **分批处理**：建议一次只重构一个模块，验证无误后再处理下一个
3. **依赖关系**：注意检查模块间的依赖关系，确保导入语句正确更新
4. **测试验证**：每个模块重构完成后进行编译和测试
5. **版本控制**：使用 Git 等版本控制工具，便于出现问题时回滚

## 优先级建议

**高优先级**：必须修改，否则无法正常编译和运行
- Java 源文件的 package 声明
- Mapper XML 文件的 namespace 和类型引用

**中优先级**：影响模块独立运行
- 创建 Application 启动类
- 配置文件的路径设置

**低优先级**：优化建议
- 注释和文档更新
- 代码规范调整

## 相关参考

- Maven 模块化项目最佳实践
- Spring Boot 多模块项目配置指南
- Java 包命名规范（Oracle 官方文档）

---

**文档版本**：1.2  
**最后更新**：2026-01-08  
**维护人员**：开发团队
